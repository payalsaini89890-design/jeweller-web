<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gold Heritage Collection | The Jewellery Atelier</title>
    <meta name="description" content="Explore the Signature Gold Collection at The Jewellery Atelier. Marwari regality meets contemporary fine jewellery design.">
    
    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Gold Heritage Collection | The Jewellery Atelier">
    <meta property="og:description" content="A curated selection of fine gold jewellery, where every piece tells a story of heritage.">

    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/collections.css">
    <link rel="stylesheet" href="../css/modal.css">
    <link rel="stylesheet" href="../css/gallery.css">
    <link rel="stylesheet" href="../css/filters.css">
    <link rel="stylesheet" href="../css/mobile-menu.css">
    <link rel="stylesheet" href="../css/dossier.css">
    <script src="https://unpkg.com/@studio-freight/lenis@1.0.34/dist/lenis.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <!-- Configuration and Supabase -->
    <script src="../js/env.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="../js/supabase-client.js"></script>
    <script src="../js/ticker.js" defer></script>
</head>

<body>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu-overlay" id="mobileMenu">
        <div style="position:absolute; top:30px; right:30px; cursor:pointer; font-size:1rem; letter-spacing:2px;" onclick="toggleMobileMenu()">CLOSE</div>
        <a href="../index.html">Home</a>
        <a href="../heritage.html">The Heritage</a>
        <a href="gold.html">Gold</a>
        <a href="platinum.html">Platinum</a>
        <a href="../ai.html">AI Concierge</a>
        <a href="../wishlist.html">Wishlist</a>
        <a href="../contact.html">Visit</a>
    </div>

    <header id="header">
        <a href="../index.html" class="logo">THE ATELIER</a>
        <nav>
            <ul>
                <li><a href="../index.html">Home</a></li>
                <li><a href="../heritage.html">The Heritage</a></li>
                <li><a href="gold.html" class="active">Gold Collection</a></li>
                <li><a href="platinum.html">Platinum Collection</a></li>
                <li><a href="../contact.html">Visit Store</a></li>
                <li><a href="../ai.html">AI Concierge</a></li>
                <li><a href="../wishlist.html" title="Wishlist" style="position: relative; font-size: 1.2rem;">♥ <span id="wishlist-count" style="display: none;">0</span></a></li>
            </ul>
            <div class="mobile-menu-toggle" onclick="toggleMobileMenu()">MENU</div>
        </nav>
    </header>

    <main id="main-content" style="padding-top: 100px;">
        <section id="home" class="page-section active">
            <div class="section-intro">
                <span class="gold-label">Est. 1980 • Flagship City</span>
                <h1 style="font-family: var(--serif); font-weight: 400; font-size: 3rem; margin-top: 20px;">The Signature Collection</h1>
                <p style="max-width: 600px; margin: 20px auto; color: var(--text-muted); font-weight: 300;">Explore our
                    curated selection of fine jewellery, where every piece tells a story of Marwari regality.</p>
            </div>

            <div id="filterContainer" style="margin-bottom: 30px;"></div>

            <div class="jewelry-grid" id="gold-grid">
                <!-- Products will be loaded dynamically from Supabase -->
                <div class="loading-state" style="text-align: center; width: 100%; color: var(--text-muted);">
                    Fine jewellery arriving soon...
                </div>
            </div>
        </section>

        <!-- Re-added heritage text section just in case, though navigation now points to separate heritage.html -->
        <!-- Keeping it hidden or removed since we now have heritage.html? The original had a heritage tab. -->
        <!-- I'll remove the second section to rely on heritage.html as the main heritage page, updating nav to point there. -->

    </main>

    <div id="dossier-root"></div>

    <footer>
        <div class="footer-grid">
            <div class="footer-brand">
                <span class="logo">THE JEWELLERY ATELIER</span>
                <p>Trusted craftsmanship in gold and silver ornaments.</p>
            </div>
            <div class="footer-col">
                <h4>Collections</h4>
                <a href="#">Bridal Sets</a>
                <a href="#">Polki & Jadau</a>
                <a href="#">Daily Wear Gold</a>
                <a href="#">Certified Diamonds</a>
            </div>
            <div class="footer-col">
                <h4>Atelier</h4>
                <a href="../heritage.html">Our Story</a>
                <a href="../heritage.html">Craftsmanship</a>
                <a href="../contact.html">Book Appointment</a>
                <a href="#">Gold Exchange</a>
            </div>
            <div class="footer-col">
                <h4>Visit Us</h4>
                <p>123 Royale Avenue, Diamond District,<br>Flagship City, 000001</p>
                <p>Ph: +91 00000 00000</p>
            </div>
        </div>
        <div class="copyright">© 2026 The Jewellery Atelier. BIS Hallmarked Purity Guaranteed.</div>
    </footer>

    <script src="../js/app.js"></script>
    <script src="../js/modal.js"></script>
    <script src="../js/gallery.js"></script>
    <script src="../js/filters.js"></script>
    <script src="../js/wishlist.js"></script>
    <script src="../js/mobile-menu.js"></script>
    <script src="../js/dossier.js"></script>
    <script>
        // --- Page Navigation (Local Tabs) ---
        // Simplified since we moved heritage to its own page, but keeping generic logic if needed for potential future tabs.
        function showPage(pageId) {
            // Note: Heritage is now external link, so this might only be used for 'home' (Collections)
            // if we had sub-tabs. For now, it just ensures the current view is active.
            // document.querySelectorAll('.page-section').forEach(p => p.classList.remove('active'));
            // document.getElementById(pageId).classList.add('active');
            // lenis.scrollTo(0);
        }

        let allItems = [];
        let filterManager = null;

        async function loadJewellery() {
            const grid = document.getElementById('gold-grid');

            if (!window.env?.TEXT_SUPABASE_URL || !window.env?.TEXT_SUPABASE_ANON_KEY) {
                grid.innerHTML = `<p style="text-align: center; width: 100%; color: var(--crimson);">Configuration Missing!</p>`;
                return;
            }

            try {
                const { data, error } = await window.supabaseText
                    .from('jewellery')
                    .select('*')
                    .eq('category', 'gold')
                    .eq('is_active', true);

                if (error) throw error;
                allItems = data || [];

                // Init Filter
                if (!filterManager) {
                    filterManager = new ProductFilter('gold', (filters) => renderGrid(filters));
                }

                renderGrid();
            } catch (err) {
                console.error('Error loading jewellery:', err);
                grid.innerHTML = '<p style="text-align: center; width: 100%;">Failed to load collection.</p>';
            }
        }

        function renderGrid(filters = null) {
            const grid = document.getElementById('gold-grid');
            let filtered = [...allItems];

            if (filters) {
                if (filters.search) {
                    filtered = filtered.filter(it => it.name.toLowerCase().includes(filters.search) || it.description?.toLowerCase().includes(filters.search));
                }
                if (filters.jewelryType.length > 0) {
                    filtered = filtered.filter(it => filters.jewelryType.includes(it.jewelry_type));
                }
                if (filters.purity.length > 0) {
                    filtered = filtered.filter(it => filters.purity.includes(it.gold_purity));
                }
                // Price filter - assumes price is like "₹1,20,000" or just numbers
                filtered = filtered.filter(it => {
                    const priceNum = parseInt(String(it.price).replace(/[^0-9]/g, '')) || 0;
                    return priceNum <= filters.priceRange || filters.priceRange === 500000;
                });
            }

            grid.innerHTML = '';
            if (filtered.length === 0) {
                grid.innerHTML = '<p style="text-align: center; width: 100%;">No items match your criteria.</p>';
                return;
            }

            filtered.forEach(item => {
                const card = document.createElement('div');
                card.className = 'product-card';
                const isLiked = wishlistManager?.isInWishlist(item.id);
                card.innerHTML = `
                    <div class="image-container" onclick="openProductDetail('${item.id}')">
                        <img src="${item.image_url}" alt="${item.name}">
                    </div>
                    <div style="display:flex; justify-content:space-between; align-items:start; margin-top:15px;">
                        <h3 onclick="openProductDetail('${item.id}')" style="margin:0; cursor:pointer;">${item.name}</h3>
                        <button class="wishlist-btn ${isLiked ? 'wishlisted' : ''}" data-wishlist-id="${item.id}" onclick="event.stopPropagation(); toggleWishlist('${item.id}')">${isLiked ? '♥' : '♡'}</button>
                    </div>
                    <span class="price-tag">${item.price}</span>
                `;
                grid.appendChild(card);
            });
        }

        window.addEventListener('DOMContentLoaded', loadJewellery);

        async function handleEnquiry() {
            const item = allItems.find(it => it.id === dossier.productId);
            openEnquiryModal(item);
        }

        /* Mobile Menu Logic */
        function toggleMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            menu.classList.toggle('active');
            if(menu.classList.contains('active')) {
                document.body.style.overflow = 'hidden';
            } else {
                document.body.style.overflow = '';
            }
        }
    </script>
</body>

</html>